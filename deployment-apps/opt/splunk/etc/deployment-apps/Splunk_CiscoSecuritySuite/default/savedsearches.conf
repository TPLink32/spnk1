[Cisco Security Suite - Overview - Global Security Events Map]
search = eventtype=cisco-security-events dest_ip!="255.255.255.255" dest_ip!="0.0.0.0" src_ip="*" | eval isLocalIP=`local-ip-list(src_ip)` | where isLocalIP!=1 AND isnotnull(threat_reason) AND threat_reason!="-" | stats count by src_ip | iplocation src_ip | geostats latfield=lat longfield=lon count by Country
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.timeRangePicker.show = true
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco Security Suite - Overview - Security Event Stats by Host]
search = eventtype=cisco-security-events | chart count,sparkline(count) as "Trend" by host | sort -count
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco Security Suite - Overview - Security Event Stats by Sourcetype]
search = eventtype=cisco-security-events | chart count,sparkline(count) as "Trend" by sourcetype | sort -count
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco Security Suite - Overview - Top Destinations]
search = eventtype=cisco-security-events dest_ip="*" dest_ip!="255.255.255.255" dest_ip!="0.0.0.0" | top dest_ip 
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco Security Suite - Overview - Top Services]
search = eventtype=cisco-security-events dest_ip!="255.255.255.255" dest_ip!="0.0.0.0" | eval port=coalesce(dest_port,src_port) | where isnotnull(port) | lookup networkservice "Port Number" as port OUTPUT "Service Name" AS service | eval service=if(isnull(service),"Port:"+tostring(port),service) | top service
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco Security Suite - Overview - Top Sources]
search = eventtype=cisco-security-events dest_ip!="255.255.255.255" dest_ip!="0.0.0.0" src_ip="*" | top src_ip 
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco Security Suite - Overview - Top Threats]
search = eventtype=cisco-security-events dest_ip!="255.255.255.255" dest_ip!="0.0.0.0" | where isnotnull(threat_reason) AND threat_reason!="-" | eval product=if(isnull(product),"Cisco",product) | eval threat_reason=if(http_action="TCP_DENIED/407","authfail",threat_reason) | eval threat_reason="["+product+"]:"+threat_reason | top limit=10 threat_reason
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco ASA - Overview - Drop Reason]
search = eventtype=cisco-firewall action=block* | top cause 
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.legend.placement = right

[Cisco ASA - Overview - Firewall Events]
search = eventtype=cisco-firewall action="*" | timechart count by action
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.stackMode = stacked
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.legend.placement = right
display.visualizations.charting.axisTitleY.text = "# Events"
display.visualizations.charting.axisTitleY.visibility = visible
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco ASA - Overview - Top Destinations]
search = eventtype=cisco-firewall | top dest_ip
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco ASA - Overview - Top Protocols]
search = eventtype=cisco-firewall service="*" | top service
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco ASA - Overview - Top Sources]
search = eventtype=cisco-firewall | top src_ip
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco ESA - Overview - Incoming Mail Over Time]
search = eventtype=cisco-esa | transaction keepevicted=true icid mid | search policy_direction="inbound" | timechart count by threat_reason
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.chart.stackMode = stacked
display.visualizations.charting.legend.placement = right

[Cisco ESA - Overview - Messages Processed]
search = eventtype=cisco-esa | timechart dc(internal_message_id) as "Messages" by host
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.legend.placement = right
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco ESA - Overview - Outgoing Mail Over Time]
search = eventtype=cisco-esa | transaction keepevicted=true icid mid | search policy_direction="outbound" | timechart count by threat_reason
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.chart.stackMode = stacked
display.visualizations.charting.legend.placement = right

[Cisco ESA - Overview - Top Recipients]
search = eventtype=cisco-esa recipient="*" | top recipient
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco ESA - Overview - Top Senders]
search = eventtype=cisco-esa sender="*" | top sender
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco ESA - Performance - Deliveries]
search = eventtype=cisco-esa | timechart dc(dcid) as "Delivery Connections" by host
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.legend.placement = right

[Cisco ESA - Performance - Injections]
search = eventtype=cisco-esa | timechart dc(icid) as "Incoming Connections" by host
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.legend.placement = right
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco ESA - Performance - Message Size]
search = eventtype=cisco-esa message_size="*" | timechart avg(message_size) as avg_size | eval avg_size = round((avg_size/(1024*1024)),2) | rename avg_size AS "Avg. Size"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.chart.stackMode = stacked
display.visualizations.charting.legend.placement = right
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco ESA - Performance - Message Size Distribution]
search = eventtype=cisco-esa message_size="*" | eval msg_size=case(message_size <= 4096, "<4K", message_size >  4096 AND message_size <= 32768, "4K-32K", message_size > 32768 AND message_size <= 131072, "32K-128K", message_size > 131072 AND message_size <= 524288, "128K-512K", message_size > 524288 AND message_size <= 1048576, "512K-1M", message_size > 1048576 AND message_size <= 2097152, "1M-2M", message_size > 2097152 AND message_size <= 4194304, "2M-4M", message_size > 4194304 AND message_size <= 8388608, "4M-8M", message_size > 8388608, ">8M") | chart count by msg_size | sort - msg_size | rename msg_size AS "Message Size" count AS Count
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = right
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco ESA - Performance - Messages]
search = eventtype=cisco-esa | timechart dc(mid) as "Messages" by host
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.legend.placement = right
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco IPS - GC - Top Attackers]
search = eventtype=cisco_ips | top limit=10 attacker 
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
[Cisco IPS - GC - Top Attacking Countries]
search = eventtype=cisco_ips | iplocation src_ip | top limit=10 Country
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
[Cisco IPS - GC - Top HostID]
search = eventtype=cisco_ips | top limit=10 hostId 
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
[Cisco IPS - GC - Top Signatures]
search = eventtype=cisco_ips | top limit=10 description | rename description as Signature 
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
[Cisco IPS - GC - Top Targets]
search = eventtype=cisco_ips | top limit=10 target 
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
[Cisco IPS - GC - Global Threat Score Over Time]
search = eventtype=cisco_ips | timechart count by gc_score
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h
[Cisco IPS - Overview - Average Risk Rating]
search = eventtype=cisco_ips | stats avg(risk_rating) as average | eval average=round(average, 1) 
dispatch.lookups = 1
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
is_visible = false
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h
[Cisco IPS - Overview - Average Threat Rating]
search = eventtype=cisco_ips | stats avg(threat_rating) as average | eval average=round(average, 1) 
dispatch.lookups = 1
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
is_visible = false
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h
[Cisco IPS - Overview - IPS Events By Severity]
search = eventtype=cisco_ips | transaction maxevents=2 maxspan=5m eventid | eval attack_count=if(isnotnull(summary_count),summary_count,1) | timechart sum(attack_count) by severity
dispatch.lookups = 1
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
is_visible = false
[Cisco IPS - Overview - IPS Severity Distribution]
search = eventtype=cisco_ips | stats count by severity | sort - count
dispatch.lookups = 1
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
is_visible = false
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h
[Cisco IPS - Overview - Top Attackers]
search = eventtype=cisco_ips | transaction maxevents=2 maxspan=5m eventid | eval attack_count=if(isnotnull(summary_count),summary_count,1) | stats sum(attack_count) as count,sparkline by attacker | sort - count 
dispatch.lookups = 1
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
is_visible = false
[Cisco IPS - Overview - Top Signatures]
search = eventtype=cisco_ips | transaction maxevents=2 maxspan=5m eventid | eval attack_count=if(isnotnull(summary_count),summary_count,1) | stats sum(attack_count) as count,sparkline by severity,sig_type,description | sort - count | rename sig_type as Type
dispatch.lookups = 1
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
is_visible = false
[Cisco IPS - Overview - Top Targets]
search = eventtype=cisco_ips | transaction maxevents=2 maxspan=5m eventid | eval attack_count=if(isnotnull(summary_count),summary_count,1) | stats sum(attack_count) as count,sparkline by target | sort - count 
dispatch.lookups = 1
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
is_visible = false
######################################################
#
# Lookup table builders
#
######################################################
[Lookup - Locations]
action.email.inline = 1
alert.suppress = 0
alert.track = 0
cron_schedule = 0 * * * *
description = Updates the ISE_Locations.csv lookup file
dispatch.earliest_time = -24h@h
dispatch.latest_time = now
enableSched = 1
run_on_startup = true
search = eventtype="css-ise" Location="*" | stats count by Location | inputlookup append=T ISE_Locations.csv | stats count by Location | table Location | outputlookup ISE_Locations.csv

[_lookup_create_interface_list]
auto_summarize.dispatch.earliest_time = -1d@h
cron_schedule = 0 0 * * *
dispatch.latest_time = now
enableSched = 1
search = sourcetype=cisco:esa* src_interface=* OR dest_interface=* \
| eval interface=trim(coalesce(src_interface,"") . "," . coalesce(dest_interface,""), ",") | makemv delim="," interface \
| stats count by interface \
| where len(interface)>0 \
| fields interface | rename interface as dest_interface |  outputlookup interface_list

[Cisco WSA - Acceptable Use - Business vs. Other]
search = eventtype=css-wsa-squid | eval usage = if(usage="Business","Business Use","Other") | timechart count by usage
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.legend.placement = none
display.visualizations.charting.axisTitleY.text = "# Transactions"
display.visualizations.charting.axisTitleY.visibility = visible
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Acceptable Use - Legal vs. Other]
search = eventtype=css-wsa-squid | eval usage = if(usage="Violation","Legal Liability","Other") | timechart count by usage
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.legend.placement = none
display.visualizations.charting.axisTitleY.text = "# Transactions"
display.visualizations.charting.axisTitleY.visibility = visible
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Acceptable Use - Personal vs. Other]
search = eventtype=css-wsa-squid | eval usage = if(usage="Personal","Personal Use","Other") | timechart count by usage
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.legend.placement = none
display.visualizations.charting.axisTitleY.text = "# Transactions"
display.visualizations.charting.axisTitleY.visibility = visible
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Acceptable Use - Top Business Categories]
search = eventtype=css-wsa-squid x_webcat_code_full="*" usage="Business" | top x_webcat_code_full | rename x_webcat_code_full as "Category"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Acceptable Use - Top Business Clients]
search = eventtype=css-wsa-squid src_ip="*" usage="Business" | top src_ip | rename src_ip as "Source IP"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Acceptable Use - Top Business Users]
search = eventtype=css-wsa-squid cs_username="*" usage="Business" | top cs_username | rename cs_username as Username
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Acceptable Use - Top Business Websites]
search = eventtype=css-wsa-squid cs_url_host="*" usage="Business" | top cs_url_host | rename cs_url_host as "Website"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Acceptable Use - Top Legal Categories]
search = eventtype=css-wsa-squid x_webcat_code_full="*" usage="Violation" | top x_webcat_code_full | rename x_webcat_code_full as "Category"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Acceptable Use - Top Legal Clients]
search = eventtype=css-wsa-squid src_ip="*" usage="Violation" | top src_ip | rename src_ip as "Source IP"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Acceptable Use - Top Legal Users]
search = eventtype=css-wsa-squid cs_username="*" usage="Violation" | top cs_username | rename cs_username as Username
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Acceptable Use - Top Legal Websites]
search = eventtype=css-wsa-squid cs_url_host="*" usage="Violation" | top cs_url_host | rename cs_url_host as "Website"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Acceptable Use - Top Personal Categories]
search = eventtype=css-wsa-squid x_webcat_code_full="*" usage="Personal" | top x_webcat_code_full | rename x_webcat_code_full as "Category"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Acceptable Use - Top Personal Clients]
search = eventtype=css-wsa-squid src_ip="*" usage="Personal" | top src_ip | rename src_ip as "Source IP"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Acceptable Use - Top Personal Users]
search = eventtype=css-wsa-squid cs_username="*" usage="Personal" | top cs_username | rename cs_username as Username
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Acceptable Use - Top Personal Websites]
search = eventtype=css-wsa-squid cs_url_host="*" usage="Personal" | top cs_url_host | rename cs_url_host as "Website"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = bar
display.visualizations.charting.legend.placement = none

[Cisco WSA - Destinations - By City]
search = eventtype=css-wsa-squid action=allow | iplocation dest_ip | eval City=if(isnotnull(City),City+","+Country,Country) | top City
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Destinations - By Country]
search = eventtype=css-wsa-squid action=allow | iplocation dest_ip | top Country
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Destinations - Top Blocked Domains]
search = eventtype=css-wsa-squid action=block* | top dest_domain
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Destinations - Top Destination Domains]
search = eventtype=css-wsa-squid action=allow* | top dest_domain
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Destinations - Top Protocols]
search = eventtype=css-wsa-squid action=allow* | eval num=lower(dest_port) | eval protocol="tcp" | lookup networkservice "Transport Protocol" as protocol, "Port Number" as dest_port OUTPUT "Service Name" as service | eval method=if(cs_url_scheme="tunnel", service+" [tunnel]", cs_url_scheme+" [direct]") | top method
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Network Resources - Bandwidth Utilization]
search = eventtype=css-wsa-squid action=allow* | eval bytes = ((bytes_in + bytes_out) * 10) / (1024 * 1024) | timechart per_second(mb) as "Bandwidth (MBps)"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Network Resources - By Usage]
search = eventtype=css-wsa-squid action=allow* | eval mb = ((bytes_in + bytes_out) * 10) / (1024 * 1024) | where isnotnull(usage) | timechart per_second(mb) as "Bandwidth (MBps)" by usage
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Network Resources - Top Categories]
search = eventtype=css-wsa-squid action=allow* | eval bw = (bytes_in + bytes_out) / (1024 * 1024) | stats sum(bw) as x by x_webcat_code_full | sort -x | head 10 | rename x as "Transfer Size (MB)", x_webcat_code_full as "Category"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Network Resources - Top Sites]
search = eventtype=css-wsa-squid action=allow* | eval bytes = (bytes_in + bytes_out) / (1024 * 1024) | stats sum(bytes) as x by dest_domain | sort -x | head 10 | rename x as "Transfer Size (MB)", dest_domain as "Destination"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Overview - Requests by Application]
search = eventtype=css-wsa-squid x_avc_app="*" x_avc_app!="-" x_avc_app!="Unknown" | top x_avc_app
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco WSA - Overview - Requests by Category]
search = eventtype=css-wsa-squid | eval Category=if(match(x_webcat_code_abbr,"C_.*"),"[CUSTOM] "+x_webcat_code_full,x_webcat_code_full) | top Category
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco WSA - Overview - Top Destination Domains]
search = eventtype=css-wsa-squid | eval bytes=bytes_in+bytes_out | stats sum(bytes) as bytecount,count by dest_domain | sort -bytecount | `resize-bytes("bytecount", bytecount)` | rename count as "# Requests", bytecount as "Transfer Size", dest_domain as "Destination"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = heatmap
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Overview - Top Users]
search = eventtype=css-wsa-squid | eval action=if(http_result="TCP_DENIED/407","block",action) | where action!="error" | eval cs_username=if(isnull(cs_username) OR cs_username="-","["+c_ip+"]",cs_username) | chart count by cs_username,action | eval count=block+allow | eval f_username=if(match(cs_username,"^\["),"*",cs_username) | eval f_ip=if(match(cs_username,"^\["),replace(cs_username,"[\[\]]",""),"*") | sort - count | table cs_username,f_username,f_ip,count,allow,block | rename cs_username as "Username",count as "# Requests", block as "Blocked", allow as "Allowed"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Overview - Web Security Events]
search = eventtype=css-wsa-squid | eval action=if(http_result="TCP_DENIED/407", "Auth Failed", action) | timechart usenull=f count by action
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.stackMode = stacked
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.legend.placement = right
display.visualizations.charting.axisTitleY.text = "# Transactions"
display.visualizations.charting.axisTitleY.visibility = visible
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Overview - Web Security Threats]
search = eventtype=css-wsa-squid threat_reason="*" threat_reason!="-" | eval threat_reason=if(http_result="TCP_DENIED/407","Auth Failure",threat_reason) | top threat_reason
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = pie
display.visualizations.charting.legend.placement = right

[Cisco WSA - Proxy Performance - Bandwidth]
search = eventtype=css-wsa-squid | eval mbytes_in = bytes_in/(1024*1024) | eval mbytes_out = bytes_out/(1024*1024) | timechart sum(mbytes_in) as "Inbound (MB)", sum(mbytes_Out) as "Outbound (MB)"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Proxy Performance - By Access Policy]
search = eventtype=css-wsa-squid | stats count by access_policy | sort -count
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Proxy Performance - Cache Performance]
search = eventtype=css-wsa-squid cache!="-" | timechart count by cache | rename hit as "Cache Hit", miss as "Cache Miss"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Proxy Performance - Request Duration]
search = eventtype=css-wsa-squid | timechart avg(duration) as "Avg Duration (ms)", max(duration) as "Peak Duration (ms)"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Proxy Performance - Requests]
search = eventtype=css-wsa-squid | eval count=1 | timechart per_second(count) AS "Requests/sec" by host
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Proxy Performance - SSL Traffic Load]
search = eventtype=css-wsa-squid | eval num=lower(dest_port) | eval protocol="tcp" | lookup networkservice "Transport Protocol" as protocol, "Port Number" as dest_port OUTPUT "Service Name" as service | eval aa = " [" + action + "]" | eval method=if(cs_url_scheme="tunnel",service+aa,cs_url_scheme+aa) | stats count by method | sort -count 
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Search Analytics - Search Providers]
search = eventtype=css-wsa-squid action="allow" cs_url_stem="*search*" | rex field=cs_url "[\?\&#](?<qarg>(video|query|search|q|search_query|p))(=|/)(?<qstr>[^\?&]+)" max_match=0 | rex field=qstr "(?<search_term>\w+)" max_match=0 | mvexpand search_term | stats dc(cs_username) as usercount,dc(search_term) as stcount by dest_domain | sort -usercount | rename usercount as "# Unique Users", stcount as "# Search Terms",dest_domain as "Search Provider"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.charting.chart = pie
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Search Analytics - Search Terms]
search = eventtype=css-wsa-squid action="allow" cs_url_stem="*search*" | rex field=cs_url "[\?\&#](?<qarg>(video|query|search|q|search_query|p))(=|/)(?<qstr>[^\?&]+)" max_match=0 | rex field=qstr "(?<search_term>\w+)" max_match=0 | top useother=f search_term | rename count as "# Searches",search_term as "Search Term"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.charting.chart = pie

[Cisco WSA - Search Analytics - Search Users]
search = eventtype=css-wsa-squid action="allow" cs_url_stem="*search*" | rex field=cs_url "[\?\&#](?<qarg>(video|query|search|q|search_query|p))(=|/)(?<qstr>[^\?&]+)" max_match=0 | rex field=qstr "(?<search_term>\w+)" max_match=0 | top cs_username | rename count as "# Searches",cs_username as "Username"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.charting.chart = pie

[Cisco WSA - Security - Top Suspicious Categories]
search = eventtype=css-wsa-squid http_result!="TCP_DENIED/407" x_wbrs_score!="-" x_wbrs_score<=6.0 | eval Category=if(match(x_webcat_code_abbr,"C_.*"),"[CUSTOM] "+x_webcat_code_full,x_webcat_code_full) | top Category
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Security - Top Client IPs]
search = eventtype=css-wsa-squid http_result!="TCP_DENIED/407" x_wbrs_score!="-" x_wbrs_score<=6.0 | top limit=10 src_ip | eval c_ip=src_ip | rename src_ip AS "Client IP" 
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Security - Top Suspicious Domains]
search = eventtype=css-wsa-squid http_result!="TCP_DENIED/407" x_wbrs_score!="-" x_wbrs_score<=6.0 | top limit=10 dest_domain | rename dest_domain as "Destination"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Security - Top Web Threat Clients]
search = eventtype=css-wsa-squid http_result!="TCP_DENIED/407" X-ScanVerdict=1 | top limit=10 src_ip | eval c_ip=src_ip | rename src_ip as "Client IP"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Security - Top Web Threat Domains]
search = eventtype=css-wsa-squid http_result!="TCP_DENIED/407" X-ScanVerdict=1 | top limit=10 dest_domain | rename dest_domain as "Destination"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Security - Top Web Threats]
search = eventtype=css-wsa-squid http_result!="TCP_DENIED/407" X-ScanVerdict=1 | top limit=10 X-ThreatName | rename X-ThreatName AS "Threat Name"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = statistics
display.general.timeRangePicker.show = true
display.statistics.rowNumbers = true
display.statistics.wrap = true
display.statistics.overlay = none

[Cisco WSA - Security - Traffic Severity Timechart]
search = eventtype=css-wsa-squid http_result!="TCP_DENIED/407" | eval severity=`cisco-wsa-score(x_wbrs_score)` | eval severity=if(X-ScanVerdict=1,"red",severity) | timechart count by severity | table _time,red,orange,yellow,blue,green
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = area
display.visualizations.charting.chart.stackMode = stacked
display.visualizations.charting.chart.nullValueMode = zero
display.visualizations.charting.chart.style = shiny
display.visualizations.charting.legend.placement = right
display.visualizations.charting.legend.labelStyle.overflowMode = ellipsisEnd
display.visualizations.charting.axisTitleY.text = "# Requests"
display.visualizations.charting.axisTitleY.visibility = visible
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Security - Web Requests by Reputation]
search = eventtype=css-wsa-squid | eval x_wbrs_score=case(x_wbrs_score="ns","unknown",x_wbrs_score="-","unknown",1=1,x_wbrs_score) | eval score=if(x_wbrs_score="unknown","unknown",floor(x_wbrs_score)) | stats count by score | sort score
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.chartHeight = 600px
display.visualizations.charting.chart = column
display.visualizations.charting.chart.nullValueMode = gaps
display.visualizations.charting.legend.placement = none
display.visualizations.charting.axisTitleY.text = "# Transactions"
display.visualizations.charting.axisTitleY.visibility = visible
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Web Request Metrics - Average Request Size]
search = eventtype=css-wsa-squid action="allow" | eval bytes=bytes_in + bytes_out | timechart min(bytes) as min, avg(bytes) as avg, max(bytes) as max
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.charting.chart = pie
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Web Request Metrics - Cache Efficiency]
search = eventtype=css-wsa-squid action="allow" | stats count by cache
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.charting.chart = pie
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Web Request Metrics - Unique Users]
search = eventtype=css-wsa-squid cs_username!="-" | timechart dc(cs_username) as "# Unique Users"
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.charting.chart = pie
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Web Request Metrics - Users with Multiple IPs]
search = eventtype=css-wsa-squid cs_username!="-" | stats dc(src_ip) as ipcount by cs_username | stats count by ipcount
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.charting.chart = pie
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h

[Cisco WSA - Web Request Metrics - Users with Multiple UAs]
search = eventtype=css-wsa-squid cs_username!="-" | stats dc(cs_user_agent) as uacount by cs_username | stats count by uacount
dispatch.lookups = 1
dispatch.earliest_time = -60m
dispatch.latest_time = now
is_visible = false
display.general.enablePreview = true
display.general.type = visualizations
display.general.timeRangePicker.show = true
display.visualizations.show = true
display.visualizations.type = charting
display.visualizations.charting.chart = pie
auto_summarize = 1
auto_summarize.dispatch.earliest_time = -1d@h
